# Implementation Plan

- [x] 1. 프로젝트 기본 구조 및 설정 파일 생성
  - 프로젝트 디렉토리 구조 생성 (models, services, utils)
  - requirements.txt 파일 작성 (google-generativeai, pandas 등)
  - 환경 설정 파일 (.env) 템플릿 생성
  - 기본 설정 클래스 (OptimizationConfig) 구현
  - _Requirements: 6.1, 6.3_

- [x] 2. 데이터 모델 및 기본 클래스 구현
  - Sample, ErrorCase, AnalysisReport, IterationState 데이터 클래스 구현
  - 기본 예외 클래스들 정의 (APIError, ValidationError 등)
  - 유틸리티 함수들 구현 (파일 I/O, 로깅 등)
  - _Requirements: 1.3, 2.4, 3.4_

- [x] 3. CSV 데이터 처리 모듈 구현
  - CSVProcessor 클래스 구현
  - samples.csv 파일 로드 및 파싱 기능
  - 문제 추출 및 정답 추출 메서드 구현
  - 데이터 검증 및 오류 처리 로직 추가
  - _Requirements: 1.1, 6.2_

- [x] 4. Gemini API 기본 연결 및 인증 구현
  - Google Generative AI 라이브러리 설정
  - API 키 관리 및 인증 로직 구현
  - 기본 API 호출 래퍼 클래스 작성
  - 연결 테스트 및 API 키 유효성 검증 기능
  - _Requirements: 6.1, 6.3_

- [x] 5. Gemini Flash 분류기 구현
  - GeminiFlashClassifier 클래스 구현
  - 단일 문장 분류 메서드 (classify_single) 구현
  - 배치 분류 메서드 (classify_batch) 구현
  - 응답 형식 검증 및 파싱 로직 추가
  - _Requirements: 1.1, 1.2, 6.2_

- [x] 6. 결과 분석 및 정확도 계산 모듈 구현
  - ResultAnalyzer 클래스 구현
  - 예측 결과와 정답 비교 로직 (compare_results) 구현
  - 정확도 계산 메서드 구현
  - 틀린 문제 추출 기능 (extract_errors) 구현
  - _Requirements: 1.2, 1.3, 1.4_

- [x] 7. API 오류 처리 및 재시도 로직 구현
  - APIErrorHandler 클래스 구현
  - 네트워크 오류, 할당량 초과 등 예외 처리
  - 지수 백오프를 통한 재시도 메커니즘 구현
  - 응답 형식 오류 복구 로직 추가
  - _Requirements: 6.1, 6.2, 6.3, 6.4_

- [x] 8. Gemini Pro 분석기 구현
  - GeminiProAnalyzer 클래스 구현
  - 오류 패턴 분석을 위한 프롬프트 작성
  - 틀린 문제와 현재 프롬프트를 분석하는 메서드 구현
  - 분석 결과를 txt 파일로 저장하는 기능 구현
  - _Requirements: 2.1, 2.2, 2.3, 2.4_

- [x] 9. 프롬프트 최적화 모듈 구현
  - PromptOptimizer 클래스 구현
  - 현재 프롬프트 로드 및 백업 기능
  - 분석 결과 기반 프롬프트 수정 로직 구현
  - 버전 관리 및 변경 로그 기록 기능
  - _Requirements: 3.1, 3.2, 3.3, 3.4_

- [x] 10. 반복 제어 및 모니터링 시스템 구현
  - IterationController 클래스 구현
  - 목표 정확도 달성 여부 확인 로직
  - 최대 반복 횟수 제한 및 조기 종료 조건
  - 진행 상황 출력 및 로깅 기능
  - _Requirements: 4.1, 4.2, 4.3, 4.4, 5.1, 5.2_

- [x] 11. 메인 최적화 루프 통합 구현
  - 전체 최적화 사이클을 관리하는 메인 클래스 구현
  - 각 컴포넌트들을 연결하는 워크플로우 구현
  - 설정 파일 기반 파라미터 관리
  - 실행 상태 추적 및 중간 결과 저장
  - _Requirements: 4.1, 4.2, 4.3, 4.4_

- [x] 12. 로깅 및 모니터링 기능 구현
  - 상세한 로깅 시스템 구현 (진행 상황, 오류, 개선 사항)
  - 각 반복별 성능 지표 추적
  - 최종 결과 요약 및 최적 프롬프트 정보 출력
  - 실행 통계 및 분석 리포트 생성
  - _Requirements: 5.1, 5.2, 5.3, 5.4_

- [x] 13. 단위 테스트 작성
  - 각 주요 클래스별 단위 테스트 작성
  - Mock API 응답을 사용한 테스트 케이스 구현
  - 데이터 처리 로직 검증 테스트
  - 오류 처리 시나리오 테스트 케이스 작성
  - _Requirements: 6.1, 6.2, 6.3, 6.4_

- [x] 14. 통합 테스트 및 E2E 테스트 구현
  - 전체 최적화 사이클 통합 테스트
  - 실제 API를 사용한 E2E 테스트 (소규모 데이터)
  - 다양한 목표 정확도 시나리오 테스트
  - 장시간 실행 안정성 테스트
  - _Requirements: 4.1, 4.2, 4.3, 4.4_

- [x] 15. 명령행 인터페이스 및 사용자 편의 기능 구현
  - argparse를 사용한 CLI 인터페이스 구현
  - 설정 파일 생성 및 수정 도구
  - 진행 상황 실시간 모니터링 기능
  - 결과 시각화 및 리포트 생성 기능
  - _Requirements: 5.1, 5.2, 5.3, 5.4_

- [x] 16. 성능 최적화 및 배치 처리 개선
  - API 호출 배치 크기 최적화
  - 메모리 사용량 최적화
  - 응답 캐싱 메커니즘 구현
  - 병렬 처리 가능한 부분 식별 및 구현
  - _Requirements: 1.1, 1.2, 6.4_

- [x] 17. 문서화 및 사용 가이드 작성
  - README.md 파일 작성 (설치, 설정, 사용법)
  - API 문서 및 클래스 다이어그램 작성
  - 설정 옵션 및 파라미터 가이드
  - 트러블슈팅 가이드 및 FAQ 작성
  - _Requirements: 5.4_

- [x] 18. 최종 검증 및 실제 데이터 테스트
  - 전체 samples.csv 데이터로 최종 테스트
  - 다양한 목표 정확도 설정으로 성능 검증
  - 메모리 사용량 및 실행 시간 측정
  - 최종 버그 수정 및 코드 정리
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 4.1, 4.2, 4.3, 4.4_

- [ ] 19. 파싱 에러 진단 및 수정
  - "Failed to parse classification" 에러의 근본 원인 분석
  - "string indices must be integers" 데이터 구조 오류 수정
  - 파싱 실패 케이스에 대한 상세 로깅 추가
  - 파싱 복구 메커니즘 구현 및 테스트
  - _Requirements: 7.1, 7.2, 7.3_

- [ ] 20. 프롬프트 엔지니어링 개선
  - 현재 최고 성능 프롬프트(system_prompt_final.txt) 분석
  - Few-shot 예시를 포함한 개선된 프롬프트 작성
  - 분류 기준을 더 명확하고 구체적으로 정의
  - Chain-of-Thought 추론 과정을 포함한 프롬프트 버전 생성
  - _Requirements: 8.1, 8.2, 8.3, 8.4_

- [ ] 21. 고급 최적화 기법 적용
  - 온도(temperature) 및 top-p 파라미터 최적화
  - 배치 크기 및 처리 방식 최적화
  - 오류 패턴 기반 적응형 프롬프트 조정
  - 성능 지표 기반 자동 하이퍼파라미터 튜닝
  - _Requirements: 7.4, 8.1_

- [ ] 22. 강화된 오류 처리 및 복구 시스템
  - 파싱 실패 시 대체 파싱 전략 구현
  - API 응답 검증 및 재요청 로직 강화
  - 부분적 성공 케이스 처리 개선
  - 실시간 오류 모니터링 및 알림 시스템
  - _Requirements: 7.1, 7.2, 7.3_

- [ ] 23. 성능 벤치마킹 및 비교 분석
  - 다양한 프롬프트 버전 간 성능 비교
  - 오류 유형별 개선 효과 측정
  - 실행 시간 및 API 호출 효율성 분석
  - 최적 설정 조합 도출 및 문서화
  - _Requirements: 7.4, 8.1, 8.2, 8.3, 8.4_